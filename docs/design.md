# 要件・設計書  

## 1. 要件定義  

### 1.1 基本情報  
- **ソフトウェア名称**: Zenn記事情報収集ツール  
- **リポジトリ名**: zenn-article-analyzer  

### 1.2 プロジェクト概要  
本プロジェクトは、Zenn APIを利用して特定のユーザーまたはパブリケーションの記事情報を取得し、以下の2種類の機能を提供することを目的としています。  
1. **集計機能 (zenn_analyzer.py)**  
   - CSVファイルに記載されたURLリストから各URLに対してAPIリクエストを行い、各エンドポイントの「パブリケーション名/ユーザー名」、記事数、および「いいね」数の合計を集計し、コンソールに出力します。  
2. **詳細情報収集機能 (zenn_article_analyzer.py)**  
   - 同じくCSVファイルのURLリストをもとに、各記事の詳細情報（記事タイトル、Publication、投稿したユーザー名、いいね数）を取得し、CSVファイルに出力します。  

### 1.3 機能要件  

#### 1.3.1 基本機能  
- CSVファイル（`url_list.csv`）からZenn APIのエンドポイントURLを読み込む。  
- 各URLに対してAPIリクエストを行い、以下の情報を取得する。  
  - **集計機能**：パブリケーション名またはユーザー名、記事数、いいね数の合計  
  - **詳細情報収集機能**：記事タイトル、Publication、投稿したユーザー名、いいね数  
- 取得したデータは、各ツールごとに次の形式で出力される。  
  - 集計機能：コンソールへのリスト出力  
  - 詳細情報収集機能：CSVファイル（`zenn_articles.csv`）への出力

#### 1.3.2 拡張機能（今後の追加予定）  
- APIリクエストのエラーハンドリング強化（レートリミット対応など）  
- GUIの追加による使いやすいインターフェースの提供  

### 1.4 非機能要件  
#### 1.4.1 性能要件  
- APIリクエストのレスポンスを適切に処理し、効率的にデータを取得する。  
- 複数のURLを高速に処理できる設計を目指す。  

#### 1.4.2 セキュリティ要件  
- APIリクエスト時のエラーハンドリングを確実に行う。  
- 不正なデータが含まれていた場合、適切に処理をスキップする。  

### 1.5 制約条件  
- Zenn APIの仕様に依存するため、APIの変更に常時対応できること。  
- Python 3.xで動作すること。  
- `requests`および`csv`を使用してAPIリクエストとファイル操作を行う。  

### 1.6 開発環境  
- **言語**: Python 3.x  
- **ライブラリ**: `requests`, `csv`  
- **開発ツール**: VSCode, GitHub  

### 1.7 成果物  
- ソースコード（zenn_analyzer.py, zenn_article_analyzer.pyなど）  
- 設計書（本書）  
- テストコード  
- README（セットアップ手順含む）  

---

## 2. システム設計  

### 2.1 システム概要設計  

#### 2.1.1 システムアーキテクチャ  
```
[CSVファイル]
    ↓
[URLリスト取得] --→ [APIクライアント]
                           │
                           ├→ [集計機能 (zenn_analyzer.py)]
                           │      ・パブリケーション名/ユーザー名取得
                           │      ・記事数、いいね数の合計計算
                           │
                           └→ [詳細情報収集機能 (zenn_article_analyzer.py)]
                                  ・記事タイトル、Publication、投稿ユーザー名、いいね数の取得
                                  ・CSVファイル（zenn_articles.csv）へ出力
```

### 2.2 詳細設計  

#### 2.2.1 クラス設計  

##### 2.2.1.1 `ZennAPIClient`  
- **役割**: Zenn APIへのリクエストを管理し、必要な記事情報を抽出する。  
- **主なメソッド**:
  - `fetch_articles(url: str) -> list`: 指定されたURLから記事情報を取得し、各ツール用に必要な情報をタプルとして返す。  
    - 集計機能の場合: (パブリケーション名/ユーザー名, 記事数, いいね数の合計)（zenn_analyzer.py）  
    - 詳細情報収集機能の場合: (記事タイトル, Publication, 投稿したユーザー名, いいね数)（zenn_article_analyzer.py）  

##### 2.2.1.2 `CSVReader`  
- **役割**: CSVファイルを読み込み、URLリストを作成する。  
- **主なメソッド**:
  - `read_csv(file_path: str) -> list`: CSVファイルから各行の最初の列を抽出してURLリストを作成する。  

##### 2.2.1.3 `MainProcessor`  
- **役割**: URLリストの読み込み、APIクライアントによるデータ取得、出力処理を統括する。  
- **主なメソッド**:
  - `process() -> None`: URLリストを読み込み、各URLから記事情報を取得し、適切な出力（コンソール出力またはCSV出力）を行う。  

### 2.3 インターフェース設計  
- **入力**:  
  - `url_list.csv`: 各行にZenn APIのエンドポイントURLが記載されている。  
- **出力**:  
  - **集計機能 (zenn_analyzer.py)**: コンソールに `(パブリケーション名/ユーザー名, 記事数, いいね数の合計)` のリストを表示。  
  - **詳細情報収集機能 (zenn_article_analyzer.py)**: CSVファイル `zenn_articles.csv` に
    「記事名」「Publication」「投稿したユーザー名」「いいね数」を出力。  

### 2.4 セキュリティ設計  
- APIリクエストのエラーハンドリングを適切に行う。  
- 不正なデータを検出した場合、ログ出力しつつスキップする。  

### 2.5 テスト設計  
- **ユニットテスト**:  
  - `ZennAPIClient.fetch_articles()` のテスト  
  - `CSVReader.read_csv()` のテスト  
- **統合テスト**:  
  - `MainProcessor.process()` のテスト（両方の機能を含むシナリオテスト）  

---

## 3. 補足  
- 2つのツールは同じリポジトリ内で管理され、用途に応じて使い分けることができる。  
- 今後の拡張として、GUIの提供やAPIリクエストの処理速度向上、エラーハンドリングの強化などが検討される。
